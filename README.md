# grade_sender
大连大学成绩监控查询程序

## 简介

本程序模拟登录正方教务系统获取本人当前学期成绩（也可以手动改学期学年），20分钟检测一次，当有新成绩公布时就发送到邮箱，本程序用到的是我学校的教务网网址。
- 第一版“手动输入验证码”的程序[Python 3.6 监控爬取成绩并推送到邮箱](https://0202zc.github.io/2018/07/25/Python-3-6-监控爬取成绩并推送到邮箱)
- 验证码识别参照了XiaoYaoII的文章[利用python3 爬取教务处实现自动查询成绩并发送给用户QQ邮箱](https://blog.csdn.net/qq_35323001/article/details/79100664)
- 使用百度云文字识别的SDK的帮助文档在此[Python SDK文档](https://ai.baidu.com/docs#/OCR-Python-SDK/top)

## 实现思想
本程序的实现主要步骤有：
1. 首先登录进入成绩查询页面
2. 将对应的所有成绩爬取下来
3. 将爬取下来的成绩进行格式化（表格）
4. 美化后的成绩表格发送到邮箱

## 详细步骤
1. 登录
   1. 得到跳转后页面的地址（为了防止登录重复，教务系统后面会跳转后在网址后面加一串随机的hash码）
   2. 利用百度云识别验证码
2. 将需要的列爬取下来
3. 每次爬取后让程序暂停20分钟，将每次所爬取的成绩数量进行对比，如果与第一次爬取的数量相同则不发邮件，否则发送邮件
